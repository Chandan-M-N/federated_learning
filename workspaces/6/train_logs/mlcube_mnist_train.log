2024-08-28 13:00:14,685 - dev.mnist - MainThread - INFO - Parameters have been read (/home/sunlab/flower/quickstart-mlcube/workspaces/6/parameters/default.parameters.yaml).
2024-08-28 13:00:14,685 - logging_configuration - MainThread - INFO - Parameters for initial model {'optimizer': 'adam', 'epochs': 1, 'batch_size': 32}
2024-08-28 13:00:14,906 - dev.mnist - MainThread - INFO - Dataset has been loaded (/home/sunlab/flower/quickstart-mlcube/workspaces/6/data/mnist.npz).
2024-08-28 13:00:14,906 - logging_configuration - MainThread - INFO - Dataset ready
2024-08-28 13:00:14,991 - logging_configuration - MainThread - INFO - Model loaded from directory 
2024-08-28 13:00:14,991 - dev.mnist - MainThread - INFO - Model has been built.
2024-08-28 13:00:14,994 - dev.mnist - MainThread - INFO - Model has been compiled.
2024-08-28 13:00:14,994 - logging_configuration - MainThread - INFO - Model has been compiled.
2024-08-28 13:00:17,423 - dev.mnist - MainThread - INFO - Model has been trained.
2024-08-28 13:00:17,423 - logging_configuration - MainThread - INFO - Model has been trained.
2024-08-28 13:00:17,423 - logging_configuration - MainThread - INFO - Created metrics directory for saving loss and accuracy
2024-08-28 13:00:17,423 - logging_configuration - MainThread - INFO - After training round 1 {'loss': '0.3023911714553833', 'accuracy': '0.9121500253677368'}
2024-08-28 13:00:17,636 - dev.mnist - MainThread - INFO - Model has been saved.
2024-08-28 13:00:17,636 - logging_configuration - MainThread - INFO - Model has been saved
2024-08-28 13:00:17,637 - logging_configuration - MainThread - INFO - Training done
2024-08-28 13:00:17,731 - logging_configuration - MainThread - INFO - Getting parameters from model saved in /model after training
2024-08-28 13:00:17,732 - logging_configuration - MainThread - INFO - Parameters after training from the model saved in /model [array([[ 7.4046679e-02,  1.8275082e-02, -1.6905658e-02, ...,
         5.8740266e-02, -2.8507806e-02,  4.2956322e-02],
       [-5.0045773e-03, -3.2985508e-03,  4.2380229e-02, ...,
         5.3900480e-03, -6.5939441e-02, -5.4650985e-02],
       [ 2.0252787e-02, -7.7760816e-02,  7.7314235e-02, ...,
         6.6915527e-03, -3.2180615e-02, -1.0635175e-02],
       ...,
       [ 2.4659410e-03,  2.5889263e-02,  4.7810875e-02, ...,
        -6.8483047e-02, -6.5182425e-02,  5.2985854e-02],
       [ 6.2540174e-05,  6.6024594e-02, -6.5577276e-02, ...,
        -6.0539186e-02,  1.7776191e-02,  7.5253330e-02],
       [ 4.7794960e-02,  1.7636068e-02,  2.0296104e-02, ...,
         2.5588959e-02, -9.8090395e-03, -4.1287947e-02]], dtype=float32), array([-0.06827028, -0.00354696, -0.0181333 ,  0.07855842,  0.04527893,
       -0.0765603 ,  0.03326457,  0.05362422,  0.10976278, -0.06467676,
        0.02748867, -0.03609257, -0.01297353,  0.00324881,  0.03111606,
       -0.01602016,  0.0244142 ,  0.02537668, -0.00497519,  0.00829264,
        0.12495398,  0.00149136, -0.00651292, -0.03476681,  0.06825197,
       -0.02772186, -0.05976848, -0.06877993,  0.02979694,  0.02040456,
       -0.06155086, -0.04588739, -0.02189853,  0.04145601, -0.01499329,
        0.01725891, -0.04581819, -0.00156544, -0.03376198, -0.0973537 ,
       -0.00252294,  0.09062857, -0.01631525,  0.05340083,  0.09379018,
        0.12338889,  0.08184089,  0.01728389, -0.0232926 , -0.01432838,
        0.08794181, -0.02165006,  0.04885975,  0.03612432,  0.01711339,
        0.03275833,  0.05173558,  0.03279223, -0.02322898,  0.07171783,
        0.08569979, -0.0067398 ,  0.07204489,  0.08169221,  0.04820597,
        0.04192758, -0.0051411 ,  0.01813177,  0.05046773, -0.04530941,
        0.07062876, -0.01383475,  0.01807773,  0.03797754, -0.0031658 ,
       -0.0107386 , -0.11275664, -0.00474889,  0.11438882,  0.01939781,
       -0.01257375,  0.03902033,  0.0678046 , -0.06129131,  0.09840521,
        0.11726262,  0.06523461, -0.06374207,  0.01714016,  0.02905882,
        0.03326851, -0.01278823, -0.02690043,  0.02472024,  0.0823606 ,
        0.08036814, -0.0166294 ,  0.02164765, -0.01584071, -0.09821338,
       -0.02255168, -0.01933917, -0.1219307 , -0.03766824, -0.01499718,
        0.13761711,  0.0099625 ,  0.06586599, -0.03397054,  0.03251294,
       -0.06857909, -0.02943867, -0.08046079,  0.11873071,  0.08597056,
        0.01690366,  0.02390842,  0.00296982,  0.07494825, -0.06395298,
        0.07283157,  0.01541636,  0.01867855,  0.03319046, -0.02727135,
        0.06543385,  0.03251922,  0.00099649], dtype=float32), array([[ 0.22733088,  0.02653985,  0.05554565, ..., -0.24824825,
         0.12465388,  0.13619143],
       [ 0.03547122, -0.3366041 ,  0.1752063 , ...,  0.00884872,
        -0.19636376, -0.12965138],
       [ 0.06561437, -0.21426462, -0.1080709 , ...,  0.03447348,
         0.2008275 , -0.15494356],
       ...,
       [ 0.20425305,  0.12948908, -0.02114171, ...,  0.25191715,
        -0.31919116, -0.1356371 ],
       [-0.23470405, -0.07974317, -0.05550029, ...,  0.03304936,
         0.00520054,  0.03521992],
       [-0.09715352,  0.34965006, -0.17351153, ..., -0.25219724,
        -0.01737618,  0.19046733]], dtype=float32), array([-0.02317659,  0.0359418 , -0.03358141, -0.06795019,  0.03597659,
        0.10470664, -0.06993932,  0.04293805, -0.02532176, -0.00344958],
      dtype=float32)]
2024-08-28 13:00:17,733 - logging_configuration - MainThread - INFO - Loading metrics from json file saved after training
2024-08-28 13:00:17,733 - logging_configuration - MainThread - INFO - Config after training {'loss': 0.3023911714553833, 'accuracy': 0.9121500253677368, 'num_examples': 1}
2024-08-28 13:00:17,733 - flwr - MainThread - INFO - Sent reply
2024-08-28 13:00:17,738 - flwr - MainThread - INFO - 
2024-08-28 13:00:17,738 - flwr - MainThread - INFO - Received: evaluate message e58085d1-e017-4d19-a90f-994c65d2b402
2024-08-28 13:00:17,740 - logging_configuration - MainThread - INFO - Parameters shared by server for evaluate [array([[ 7.4046679e-02,  1.8275082e-02, -1.6905658e-02, ...,
         5.8740266e-02, -2.8507806e-02,  4.2956322e-02],
       [-5.0045773e-03, -3.2985508e-03,  4.2380229e-02, ...,
         5.3900480e-03, -6.5939441e-02, -5.4650985e-02],
       [ 2.0252787e-02, -7.7760816e-02,  7.7314235e-02, ...,
         6.6915527e-03, -3.2180615e-02, -1.0635175e-02],
       ...,
       [ 2.4659410e-03,  2.5889263e-02,  4.7810875e-02, ...,
        -6.8483047e-02, -6.5182425e-02,  5.2985854e-02],
       [ 6.2540174e-05,  6.6024594e-02, -6.5577276e-02, ...,
        -6.0539186e-02,  1.7776191e-02,  7.5253330e-02],
       [ 4.7794960e-02,  1.7636068e-02,  2.0296104e-02, ...,
         2.5588959e-02, -9.8090395e-03, -4.1287947e-02]], dtype=float32), array([-0.06827028, -0.00354696, -0.0181333 ,  0.07855842,  0.04527893,
       -0.0765603 ,  0.03326457,  0.05362422,  0.10976278, -0.06467676,
        0.02748867, -0.03609257, -0.01297353,  0.00324881,  0.03111606,
       -0.01602016,  0.0244142 ,  0.02537668, -0.00497519,  0.00829264,
        0.12495398,  0.00149136, -0.00651292, -0.03476681,  0.06825197,
       -0.02772186, -0.05976848, -0.06877993,  0.02979694,  0.02040456,
       -0.06155086, -0.04588739, -0.02189853,  0.04145601, -0.01499329,
        0.01725891, -0.04581819, -0.00156544, -0.03376198, -0.0973537 ,
       -0.00252294,  0.09062857, -0.01631525,  0.05340083,  0.09379018,
        0.12338889,  0.08184089,  0.01728389, -0.0232926 , -0.01432838,
        0.08794181, -0.02165006,  0.04885975,  0.03612432,  0.01711339,
        0.03275833,  0.05173558,  0.03279223, -0.02322898,  0.07171783,
        0.08569979, -0.0067398 ,  0.07204489,  0.08169221,  0.04820597,
        0.04192758, -0.0051411 ,  0.01813177,  0.05046773, -0.04530941,
        0.07062876, -0.01383475,  0.01807773,  0.03797754, -0.0031658 ,
       -0.0107386 , -0.11275664, -0.00474889,  0.11438882,  0.01939781,
       -0.01257375,  0.03902033,  0.0678046 , -0.06129131,  0.09840521,
        0.11726262,  0.06523461, -0.06374207,  0.01714016,  0.02905882,
        0.03326851, -0.01278823, -0.02690043,  0.02472024,  0.0823606 ,
        0.08036814, -0.0166294 ,  0.02164765, -0.01584071, -0.09821338,
       -0.02255168, -0.01933917, -0.1219307 , -0.03766824, -0.01499718,
        0.13761711,  0.0099625 ,  0.06586599, -0.03397054,  0.03251294,
       -0.06857909, -0.02943867, -0.08046079,  0.11873071,  0.08597056,
        0.01690366,  0.02390842,  0.00296982,  0.07494825, -0.06395298,
        0.07283157,  0.01541636,  0.01867855,  0.03319046, -0.02727135,
        0.06543385,  0.03251922,  0.00099649], dtype=float32), array([[ 0.22733088,  0.02653985,  0.05554565, ..., -0.24824825,
         0.12465388,  0.13619143],
       [ 0.03547122, -0.3366041 ,  0.1752063 , ...,  0.00884872,
        -0.19636376, -0.12965138],
       [ 0.06561437, -0.21426462, -0.1080709 , ...,  0.03447348,
         0.2008275 , -0.15494356],
       ...,
       [ 0.20425305,  0.12948908, -0.02114171, ...,  0.25191715,
        -0.31919116, -0.1356371 ],
       [-0.23470405, -0.07974317, -0.05550029, ...,  0.03304936,
         0.00520054,  0.03521992],
       [-0.09715352,  0.34965006, -0.17351153, ..., -0.25219724,
        -0.01737618,  0.19046733]], dtype=float32), array([-0.02317659,  0.0359418 , -0.03358141, -0.06795019,  0.03597659,
        0.10470664, -0.06993932,  0.04293805, -0.02532176, -0.00344958],
      dtype=float32)] and config {}
2024-08-28 13:00:17,943 - logging_configuration - MainThread - INFO - Saved the model into model_in and the weights of model are [array([[ 7.4046679e-02,  1.8275082e-02, -1.6905658e-02, ...,
         5.8740266e-02, -2.8507806e-02,  4.2956322e-02],
       [-5.0045773e-03, -3.2985508e-03,  4.2380229e-02, ...,
         5.3900480e-03, -6.5939441e-02, -5.4650985e-02],
       [ 2.0252787e-02, -7.7760816e-02,  7.7314235e-02, ...,
         6.6915527e-03, -3.2180615e-02, -1.0635175e-02],
       ...,
       [ 2.4659410e-03,  2.5889263e-02,  4.7810875e-02, ...,
        -6.8483047e-02, -6.5182425e-02,  5.2985854e-02],
       [ 6.2540174e-05,  6.6024594e-02, -6.5577276e-02, ...,
        -6.0539186e-02,  1.7776191e-02,  7.5253330e-02],
       [ 4.7794960e-02,  1.7636068e-02,  2.0296104e-02, ...,
         2.5588959e-02, -9.8090395e-03, -4.1287947e-02]], dtype=float32), array([-0.06827028, -0.00354696, -0.0181333 ,  0.07855842,  0.04527893,
       -0.0765603 ,  0.03326457,  0.05362422,  0.10976278, -0.06467676,
        0.02748867, -0.03609257, -0.01297353,  0.00324881,  0.03111606,
       -0.01602016,  0.0244142 ,  0.02537668, -0.00497519,  0.00829264,
        0.12495398,  0.00149136, -0.00651292, -0.03476681,  0.06825197,
       -0.02772186, -0.05976848, -0.06877993,  0.02979694,  0.02040456,
       -0.06155086, -0.04588739, -0.02189853,  0.04145601, -0.01499329,
        0.01725891, -0.04581819, -0.00156544, -0.03376198, -0.0973537 ,
       -0.00252294,  0.09062857, -0.01631525,  0.05340083,  0.09379018,
        0.12338889,  0.08184089,  0.01728389, -0.0232926 , -0.01432838,
        0.08794181, -0.02165006,  0.04885975,  0.03612432,  0.01711339,
        0.03275833,  0.05173558,  0.03279223, -0.02322898,  0.07171783,
        0.08569979, -0.0067398 ,  0.07204489,  0.08169221,  0.04820597,
        0.04192758, -0.0051411 ,  0.01813177,  0.05046773, -0.04530941,
        0.07062876, -0.01383475,  0.01807773,  0.03797754, -0.0031658 ,
       -0.0107386 , -0.11275664, -0.00474889,  0.11438882,  0.01939781,
       -0.01257375,  0.03902033,  0.0678046 , -0.06129131,  0.09840521,
        0.11726262,  0.06523461, -0.06374207,  0.01714016,  0.02905882,
        0.03326851, -0.01278823, -0.02690043,  0.02472024,  0.0823606 ,
        0.08036814, -0.0166294 ,  0.02164765, -0.01584071, -0.09821338,
       -0.02255168, -0.01933917, -0.1219307 , -0.03766824, -0.01499718,
        0.13761711,  0.0099625 ,  0.06586599, -0.03397054,  0.03251294,
       -0.06857909, -0.02943867, -0.08046079,  0.11873071,  0.08597056,
        0.01690366,  0.02390842,  0.00296982,  0.07494825, -0.06395298,
        0.07283157,  0.01541636,  0.01867855,  0.03319046, -0.02727135,
        0.06543385,  0.03251922,  0.00099649], dtype=float32), array([[ 0.22733088,  0.02653985,  0.05554565, ..., -0.24824825,
         0.12465388,  0.13619143],
       [ 0.03547122, -0.3366041 ,  0.1752063 , ...,  0.00884872,
        -0.19636376, -0.12965138],
       [ 0.06561437, -0.21426462, -0.1080709 , ...,  0.03447348,
         0.2008275 , -0.15494356],
       ...,
       [ 0.20425305,  0.12948908, -0.02114171, ...,  0.25191715,
        -0.31919116, -0.1356371 ],
       [-0.23470405, -0.07974317, -0.05550029, ...,  0.03304936,
         0.00520054,  0.03521992],
       [-0.09715352,  0.34965006, -0.17351153, ..., -0.25219724,
        -0.01737618,  0.19046733]], dtype=float32), array([-0.02317659,  0.0359418 , -0.03358141, -0.06795019,  0.03597659,
        0.10470664, -0.06993932,  0.04293805, -0.02532176, -0.00344958],
      dtype=float32)] and parameters [array([[ 7.4046679e-02,  1.8275082e-02, -1.6905658e-02, ...,
         5.8740266e-02, -2.8507806e-02,  4.2956322e-02],
       [-5.0045773e-03, -3.2985508e-03,  4.2380229e-02, ...,
         5.3900480e-03, -6.5939441e-02, -5.4650985e-02],
       [ 2.0252787e-02, -7.7760816e-02,  7.7314235e-02, ...,
         6.6915527e-03, -3.2180615e-02, -1.0635175e-02],
       ...,
       [ 2.4659410e-03,  2.5889263e-02,  4.7810875e-02, ...,
        -6.8483047e-02, -6.5182425e-02,  5.2985854e-02],
       [ 6.2540174e-05,  6.6024594e-02, -6.5577276e-02, ...,
        -6.0539186e-02,  1.7776191e-02,  7.5253330e-02],
       [ 4.7794960e-02,  1.7636068e-02,  2.0296104e-02, ...,
         2.5588959e-02, -9.8090395e-03, -4.1287947e-02]], dtype=float32), array([-0.06827028, -0.00354696, -0.0181333 ,  0.07855842,  0.04527893,
       -0.0765603 ,  0.03326457,  0.05362422,  0.10976278, -0.06467676,
        0.02748867, -0.03609257, -0.01297353,  0.00324881,  0.03111606,
       -0.01602016,  0.0244142 ,  0.02537668, -0.00497519,  0.00829264,
        0.12495398,  0.00149136, -0.00651292, -0.03476681,  0.06825197,
       -0.02772186, -0.05976848, -0.06877993,  0.02979694,  0.02040456,
       -0.06155086, -0.04588739, -0.02189853,  0.04145601, -0.01499329,
        0.01725891, -0.04581819, -0.00156544, -0.03376198, -0.0973537 ,
       -0.00252294,  0.09062857, -0.01631525,  0.05340083,  0.09379018,
        0.12338889,  0.08184089,  0.01728389, -0.0232926 , -0.01432838,
        0.08794181, -0.02165006,  0.04885975,  0.03612432,  0.01711339,
        0.03275833,  0.05173558,  0.03279223, -0.02322898,  0.07171783,
        0.08569979, -0.0067398 ,  0.07204489,  0.08169221,  0.04820597,
        0.04192758, -0.0051411 ,  0.01813177,  0.05046773, -0.04530941,
        0.07062876, -0.01383475,  0.01807773,  0.03797754, -0.0031658 ,
       -0.0107386 , -0.11275664, -0.00474889,  0.11438882,  0.01939781,
       -0.01257375,  0.03902033,  0.0678046 , -0.06129131,  0.09840521,
        0.11726262,  0.06523461, -0.06374207,  0.01714016,  0.02905882,
        0.03326851, -0.01278823, -0.02690043,  0.02472024,  0.0823606 ,
        0.08036814, -0.0166294 ,  0.02164765, -0.01584071, -0.09821338,
       -0.02255168, -0.01933917, -0.1219307 , -0.03766824, -0.01499718,
        0.13761711,  0.0099625 ,  0.06586599, -0.03397054,  0.03251294,
       -0.06857909, -0.02943867, -0.08046079,  0.11873071,  0.08597056,
        0.01690366,  0.02390842,  0.00296982,  0.07494825, -0.06395298,
        0.07283157,  0.01541636,  0.01867855,  0.03319046, -0.02727135,
        0.06543385,  0.03251922,  0.00099649], dtype=float32), array([[ 0.22733088,  0.02653985,  0.05554565, ..., -0.24824825,
         0.12465388,  0.13619143],
       [ 0.03547122, -0.3366041 ,  0.1752063 , ...,  0.00884872,
        -0.19636376, -0.12965138],
       [ 0.06561437, -0.21426462, -0.1080709 , ...,  0.03447348,
         0.2008275 , -0.15494356],
       ...,
       [ 0.20425305,  0.12948908, -0.02114171, ...,  0.25191715,
        -0.31919116, -0.1356371 ],
       [-0.23470405, -0.07974317, -0.05550029, ...,  0.03304936,
         0.00520054,  0.03521992],
       [-0.09715352,  0.34965006, -0.17351153, ..., -0.25219724,
        -0.01737618,  0.19046733]], dtype=float32), array([-0.02317659,  0.0359418 , -0.03358141, -0.06795019,  0.03597659,
        0.10470664, -0.06993932,  0.04293805, -0.02532176, -0.00344958],
      dtype=float32)]
2024-08-28 13:00:17,943 - logging_configuration - MainThread - INFO - Initiating the evaluate task from mlcube.py
